# ๐๏ธ๐ฅ ุขุณุจโูพุฐุฑ ุดูุงุฑู ด: ุทุฑุงุญ ูุงุงูู (Insecure Design)

## ๐ค ุงู ฺู ุจู ุฒุจุงู ุณุงุฏูุ

ุชุตูุฑ ฺฉู ูโุฎูุง ู ุฎููู ุจุณุงุฒ. ู ูุนูุงุฑ ูุงุฏ ู ููุดู ูโฺฉุดู ฺฉู... **ุจุฏูู ุฏุฑ ูุฑูุฏ!** ๐ชโ

ุชู ูโฺฏ: "ูู ูุนูุงุฑ! ุฎููู ุฏุฑ ูุฏุงุฑู!"

ูุนูุงุฑ ูฺฏู: "ูฺฏุฑุงู ูุจุงุดุ ุจุนุฏุง ฺฉ ูุตู ูโฺฉูู!"

ุจุนุฏ ุฎููู ุฑู ูโุณุงุฒู ุจุง ุจูุชุฑู ูุตุงูุญุ ุจูุชุฑู ููุงุดุ ุจูุชุฑู ููู ฺ... ูู **ุงุณุงุณุง ุทุฑุงุญ ุบูุทู!** ๐๏ธ

ููู ุงุชูุงู ุชู ุจุฑูุงููโููุณ ูู ูโุงูุชู. ุจุนุถ ููุชุง ฺฉุฏ ฺฉุงููุง ุฏุฑุณุช ููุดุชู ุดุฏู ูู **ุทุฑุงุญ ฺฉู ุณุณุชู ุงุฒ ุงูู ุงุดุชุจุงูู!**

## ๐ฎ ูุซุงู ุจุงูุฒู: ุจุงูฺฉ ุขููุงู ุจุฏูู ูุญุฏูุฏุช! ๐ฆ

ู ุจุงูฺฉ ุขููุงู ุทุฑุงุญ ูโฺฉูู:

```javascript
// ุชุงุจุน ุงูุชูุงู ูพูู
function transferMoney(from, to, amount) {
    // ฺฺฉ ูโฺฉูู ููุฌูุฏ ฺฉุงููุ
    if (accounts[from].balance >= amount) {
        accounts[from].balance -= amount;
        accounts[to].balance += amount;
        return "ูููู! โ";
    }
    return "ููุฌูุฏ ฺฉุงู ูุณุช! โ";
}
```

ุฎูุจ ุจู ูุธุฑ ูุงุฏ! ูู... **ูฺ ูุญุฏูุฏุช ุจุฑุง ุชุนุฏุงุฏ ุฏูุนุงุช ุงูุชูุงู ูุฐุงุดุชู!** ๐ฑ

```javascript
// ูฺฉุฑ:
for (let i = 0; i < 1000000; i++) {
    transferMoney('victim', 'hacker', 1); // ูุฑ ุจุงุฑ ฑ ุชููู!
}

// ุง ุงูฺฉู:
while (true) {
    transferMoney('victim', 'hacker', 0.01);
    // ููููโูุง ุจุงุฑ ุฏุฑ ุซุงูู! ๐ธ๐ธ๐ธ
}
```

ูุดฺฉู ฺฉุฏ ูุจูุฏ! **ูุดฺฉู ุทุฑุงุญ ุจูุฏ!** ูุง ุจุงุฏ ุงุฒ ุงูู ูฺฉุฑ ูโฺฉุฑุฏู ุจู:
- ูุญุฏูุฏุช ุชุนุฏุงุฏ ุชุฑุงฺฉูุด
- ุชุงุฏ ุฏู ูุฑุญููโุง
- ุชุงุฎุฑ ุจู ุชุฑุงฺฉูุดโูุง
- ู...

## ๐ช ูุซุงูโูุง ูุงูุน

### ูุซุงู ฑ: ุณุงุช ูุฑุนูโฺฉุด ุงุญููุงูู ๐ฒ

```javascript
// ุณุงุช ูุฑุนูโฺฉุด ฺฉู ุจุฑูุฏู ุฑู ุงูุฌูุฑ ูุดุฎุต ูโฺฉูู:
function selectWinner(participants) {
    const randomIndex = Math.floor(Math.random() * participants.length);
    return participants[randomIndex];
}

// ุจู ูุธุฑ ุฎูุจู! ูู...
// ูฺฉุฑ ูโุชููู ฑ ูููู ุจุงุฑ ุซุจุชโูุงู ฺฉูู! ๐

participants = [
    "hacker", "hacker", "hacker", ... // ฑ ูููู ุจุงุฑ!
    "ali",  // ู ุจุงุฑ! ๐ข
    "sara"  // ู ุจุงุฑ!
]

// ุงุญุชูุงู ุจุฑูุฏู ุดุฏู ูฺฉุฑ = นน.นนนูช
```

**ุทุฑุงุญ ุฏุฑุณุช ฺ ุจูุฏุ**
- ู ููุฑ ููุท ู ุจุงุฑ ูโุชููู ุซุจุชโูุงู ฺฉูู (ุจุง ุดูุงุฑู ูู ุง ุงูู)
- ูุญุฏูุฏุช ุชุนุฏุงุฏ ุซุจุชโูุงู ุงุฒ ู IP
- ุชุงุฏ ููุช

### ูุซุงู ฒ: ุณุณุชู ุฑุฒุฑู ุจูุท ุจโูฺฉุฑ โ๏ธ

```javascript
// ุฑุฒุฑู ุตูุฏู ููุงูพูุง
function reserveSeat(flightId, seatNumber, userId) {
    if (seats[seatNumber].isAvailable) {
        seats[seatNumber].isAvailable = false;
        seats[seatNumber].userId = userId;
        return "ุฑุฒุฑู ุดุฏ! โ";
    }
    return "ุตูุฏู ุฑุฒุฑู ุดุฏู! โ";
}

// ูุดฺฉู: ููุช ฒ ููุฑ ููุฒูุงู ุฑุฒุฑู ฺฉูู ฺุ
```

**ุณูุงุฑู:**
1. ุนู ฺฺฉ ูโฺฉูู โ ุตูุฏู ฑฒA ุฎุงูู โ
2. ุณุงุฑุง ฺฺฉ ูโฺฉูู โ ุตูุฏู ฑฒA ุฎุงูู โ (ูููุฒ ุฑุฒุฑู ูุดุฏู!)
3. ุนู ุฑุฒุฑู ูโฺฉูู โ
4. ุณุงุฑุง ุฑุฒุฑู ูโฺฉูู โ (ุงูู ุงูู! ๐ฑ)
5. ุชู ููุงูพูุง ุนู ู ุณุงุฑุง ุฏุงุฑู ุณุฑ ู ุตูุฏู ุฏุนูุง ูโฺฉูู! ๐ฅ

**ุทุฑุงุญ ุฏุฑุณุช:**
```javascript
// ุงุณุชูุงุฏู ุงุฒ Lock ุง Transaction
async function reserveSeat(flightId, seatNumber, userId) {
    const transaction = await db.startTransaction();

    try {
        // ููู ฺฉุฑุฏู ุงู ุฑุฏู ุชุง ุชููู ุจุดู
        const seat = await db.query(
            'SELECT * FROM seats WHERE id = ? FOR UPDATE',
            [seatNumber]
        );

        if (seat.isAvailable) {
            await db.query(
                'UPDATE seats SET isAvailable = false, userId = ? WHERE id = ?',
                [userId, seatNumber]
            );
            await transaction.commit();
            return "ุฑุฒุฑู ุดุฏ! โ";
        }

        await transaction.rollback();
        return "ุตูุฏู ุฑุฒุฑู ุดุฏู! โ";
    } catch (error) {
        await transaction.rollback();
        throw error;
    }
}
```

### ูุซุงู ณ: ูุฑู ุชูุงุณ ุจุฏูู ูุญุฏูุฏุช ๐ง

```javascript
// ูุฑู ุชูุงุณ ุจุง ูุง
app.post('/contact', (req, res) => {
    const { name, email, message } = req.body;

    sendEmail({
        to: 'support@company.com',
        from: email,
        subject: `ูพุงู ุงุฒ ${name}`,
        body: message
    });

    res.send('ูพุงู ุดูุง ุงุฑุณุงู ุดุฏ! โ');
});
```

**ฺู ูุดฺฉู ุฏุงุฑูุ**
- ูฺ ูุญุฏูุฏุช ูุฏุงุฑู!
- ูฺฉุฑ ูโุชููู ููููโูุง ุงูู ุงุณูพู ุจูุฑุณุชู! ๐ง๐ง๐ง
- ูโุชููู ุจู ุนููุงู ุณุฑูุณ ุงุฑุณุงู ุงูู ูุฌุงู ุงุฒุด ุงุณุชูุงุฏู ฺฉูู!

**ุทุฑุงุญ ุฏุฑุณุช:**
```javascript
// ุจุง Rate Limiting ู CAPTCHA
const rateLimit = require('express-rate-limit');

const contactLimiter = rateLimit({
    windowMs: 15 * 60 * 1000, // ฑต ุฏููู
    max: 3, // ุญุฏุงฺฉุซุฑ ณ ุฏุฑุฎูุงุณุช
    message: 'ุฎู ุฒุงุฏ ูพุงู ูุฑุณุชุงุฏ! ฺฉู ุตุจุฑ ฺฉู! ๐'
});

app.post('/contact', contactLimiter, async (req, res) => {
    const { name, email, message, captcha } = req.body;

    // ฺฺฉ ฺฉุฑุฏู ฺฉูพฺุง
    if (!verifyCaptcha(captcha)) {
        return res.status(400).send('ฺฉูพฺุง ุฑู ุญู ฺฉู! ๐ค');
    }

    // ุงุฑุณุงู ุงูู...
});
```

## ๐ฏ ุชูุงูุช Insecure Design ุจุง ุจุงฺฏ ูุนููู

### ๐ ุจุงฺฏ ูุนููู:
```javascript
// ุงุฏููู ุฑูุช password ุฑู hash ฺฉูู (ุจุงฺฏ ูพุงุฏูโุณุงุฒ)
db.save({ username, password });
```

### ๐๏ธ Insecure Design:
```javascript
// ุงุตูุง ูฺฉุฑ ูฺฉุฑุฏู ฺฉู ุจุงุฏ rate limiting ุฏุงุดุชู ุจุงุดู!
// ุณุณุชู ุทุฑุงุญโุงุด ุงุฒ ุงูู ุบูุทู!
```

**ุชูุงูุช:**
- ุจุงฺฏ = ฺฉุฏ ุงุดุชุจุงู ููุดุชู
- Insecure Design = ุงุตูุง ูฺฉุฑ ูฺฉุฑุฏู ุจู ูุดฺฉู ุงููุช!

## ๐ก๏ธ ฺุทูุฑ ุทุฑุงุญ ุงูู ุฏุงุดุชู ุจุงุดูุ

### ฑ. Threat Modeling (ูุฏูโุณุงุฒ ุชูุฏุฏ) ๐ง

**ูุจู ุงุฒ ฺฉุฏ ุฒุฏูุ ุจุดู ูฺฉุฑ ฺฉู:**

โ ฺู ฺฉุณุง ูโุฎูุงู ุจู ุณุณุชูู ุญููู ฺฉููุ
โ ฺุฌูุฑ ูโุชููู ุญููู ฺฉููุ
โ ฺู ุงุทูุงุนุงุช ูููู ู ุจุงุฏ ูุญุงูุธุช ุจุดูุ
โ ุจุฏุชุฑู ุณูุงุฑู ฺฉู ูโุชููู ุงุชูุงู ุจูุชู ฺูุ

**ูุซุงู:**
```
ุณุณุชู: ูุฑูุดฺฏุงู ุขููุงู

ุชูุฏุฏุงุช:
- ๐ฏ ูฺฉุฑ ูโุฎูุงุฏ ูุญุตููุงุช ุฑู ููุช ุจุฎุฑู
- ๐ฏ ุฑูุจ ูโุฎูุงุฏ ูุณุช ูุดุชุฑุง ุฑู ุจุฏุฒุฏู
- ๐ฏ ูฺฉุฑ ูโุฎูุงุฏ ุณุงุช ุฑู ุงุฒ ฺฉุงุฑ ุจูุฏุงุฒู (DoS)

ุฑุงู ุญูโูุง:
- โ ุณุณุชู ูพุฑุฏุงุฎุช ูุนุชุจุฑ (ูู ุฏุณุชโฺฉุงุฑ ูพุฐุฑ)
- โ ุฏุณุชุฑุณ ุจู ูุณุช ูุดุชุฑุง ููุท ุจุง ุงุญุฑุงุฒ ููุช ูู
- โ Rate limiting ู CAPTCHA
```

### ฒ. Security by Default (ุงููุช ุจู ุตูุฑุช ูพุดโูุฑุถ) ๐

```javascript
// โ ุจุฏ - ุจุงุฏ ุจู ุตูุฑุช ุฏุณุช ุงููุช ุฑู ูุนุงู ฺฉู
const app = express();
// ุฎุทุฑูุงฺฉู! ๐ฑ

// โ ุฎูุจ - ุจู ุตูุฑุช ูพุดโูุฑุถ ุงููู
const app = express();
app.use(helmet()); // ุงููุช
app.use(cors({ origin: 'https://mysite.com' })); // ูุญุฏูุฏ ฺฉุฑุฏู CORS
app.use(rateLimit({ max: 100 })); // ูุญุฏูุฏ ฺฉุฑุฏู ุฏุฑุฎูุงุณุชโูุง
// ุญุงูุง ุงููู! ๐
```

### ณ. Principle of Least Privilege (ฺฉูุชุฑู ุฏุณุชุฑุณ) ๐ช

```javascript
// โ ุจุฏ - ููู ุจู ููู ฺ ุฏุณุชุฑุณ ุฏุงุฑู
app.get('/api/data', (req, res) => {
    const data = database.getAllData(); // ููู ฺ!
    res.json(data);
});

// โ ุฎูุจ - ูุฑ ฺฉุณ ููุท ุจู ฺุฒ ฺฉู ูุงุฒ ุฏุงุฑู ุฏุณุชุฑุณ ุฏุงุฑู
app.get('/api/data', authenticateUser, (req, res) => {
    const data = database.getUserData(req.user.id); // ููุท ุฏุงุฏู ุฎูุฏุด
    res.json(data);
});
```

### ด. Defense in Depth (ุฏูุงุน ฺูุฏูุงู) ๐ง

ูุซู ูพุงุฒ! ฺูุฏ ูุงู ุญูุงุธุช! ุงฺฏู ฺฉ ุดฺฉุณุชุ ุจูู ูุณุชู!

```javascript
// ูุงู ฑ: Firewall
// ูุงู ฒ: Rate Limiting
app.use(rateLimit({ max: 100 }));

// ูุงู ณ: Authentication
app.use(authenticateUser);

// ูุงู ด: Authorization
app.use(checkPermissions);

// ูุงู ต: Input Validation
app.post('/api/data', validateInput, (req, res) => {
    // ูุงู ถ: Prepared Statements
    db.query('SELECT * FROM users WHERE id = ?', [req.body.id]);
});

// ุงฺฏู ูฺฉุฑ ุงุฒ ต ุชุง ุฑุฏ ุดุฏุ ุจุงุฒ ูุงู ุดุดู ูุณุช! ๐ช
```

### ต. Fail Securely (ุดฺฉุณุช ุงูู) ๐

```javascript
// โ ุจุฏ - ููุช ุงุฑูุฑ ูุฏูุ ููู ุฑู ุฑุงู ูุฏู!
app.use((err, req, res, next) => {
    console.log("Error:", err);
    next(); // ุจุง ุชู! ๐ฑ
});

// โ ุฎูุจ - ููุช ุงุฑูุฑ ูุฏูุ ุฏุณุชุฑุณ ุฑู ูุทุน ูโฺฉูู
app.use((err, req, res, next) => {
    console.log("Error:", err);
    res.status(500).send("ูุดฺฉู ูพุด ุงููุฏ! ุฏุณุชุฑุณ ููููุน! ๐ซ");
    // ู ุฏุฑุฎูุงุณุช ุฑู ูุชููู ูโฺฉูู
});
```

## ๐ฏ ฺฺฉโูุณุช ุทุฑุงุญ ุงูู

ูุจู ุงุฒ ุดุฑูุน ูพุฑูฺู:
- โ Threat Modeling ุงูุฌุงู ุฏุงุฏ?
- โ ููุดโูุง ฺฉุงุฑุจุฑ (User Roles) ุฑู ูุดุฎุต ฺฉุฑุฏุ
- โ ูฺฉุฑ ฺฉุฑุฏ ฺฉุฌุงูุง ูุงุฒ ุจู Rate Limiting ุฏุงุฑูุ
- โ ูฺฉุฑ ฺฉุฑุฏ ฺฉุฌุงูุง ูุงุฒ ุจู Logging ุฏุงุฑูุ
- โ ุงุญุฑุงุฒ ููุช ฺูุฏูุฑุญููโุง ุฑู ุจุฑุง ฺฉุงุฑุง ุญุณุงุณ ุฏุฑ ูุธุฑ ฺฏุฑูุชุ
- โ ุจุฑุง ุชุฑุงฺฉูุดโูุง ูุงูุ ุชุงุฏ ุฏูุจุงุฑู ูโุฎูุงุ
- โ ูฺฉุฑ ฺฉุฑุฏ ฺฉู ุณุณุชู ุฏุฑ ุจุฑุงุจุฑ DoS ููุงูู ุจุงุดูุ

## ๐ ุชูุฑู: ุทุฑุงุญ ุงูู

**ุณูุงุฑู:** ูโุฎูุง ู ุณุณุชู ุฑุงโฺฏุฑ ุขููุงู ุจุณุงุฒ. ฺู ฺุฒุง ุฑู ุจุงุฏ ุฏุฑ ูุธุฑ ุจฺฏุฑุ

<details>
<summary>ุฌูุงุจ ุฑู ุจุจู</summary>

**ุงูุฒุงูุงุช ุงููุช:**

1. **ฺฉ ููุฑ = ฺฉ ุฑุง**
   - ุงุญุฑุงุฒ ููุช ุจุง ฺฉุฏ ูู
   - ุฌููฺฏุฑ ุงุฒ ุฑุงโุฏุงุฏู ฺูุฏุจุงุฑู

2. **ูุญุฑูุงูฺฏ**
   - ูุจุงุฏ ฺฉุณ ุจูููู ููุงู ุจู ฺฉ ุฑุง ุฏุงุฏู
   - ุฑุงโูุง ุฑูุฒูฺฏุงุฑ ุจุดู

3. **ฺฉูพุงุฑฺฺฏ**
   - ูุจุงุฏ ุจุดู ุฑุง ฺฉุณ ุฑู ุชุบุฑ ุฏุงุฏ
   - ุงุณุชูุงุฏู ุงุฒ Digital Signature

4. **ุฏุฑ ุฏุณุชุฑุณ ุจูุฏู**
   - ุณุณุชู ูุจุงุฏ ุงุฒ ฺฉุงุฑ ุจูุชู
   - Rate Limiting
   - CDN ุจุฑุง ุชูุฒุน ุจุงุฑ

5. **ูุงุจู ููุฒ**
   - ูุงฺฏ ููู ฺุฒ (ุจุฏูู ูู ุฑูุชู ุฑุงโูุง)
   - ุงูฺฉุงู ุดูุงุฑุด ูุฌุฏุฏ

6. **ูุญุฏูุฏุช ุฒูุงู**
   - ููุท ุชู ุฒูุงู ูุดุฎุต ุจุดู ุฑุง ุฏุงุฏ
   - ุฒูุงู ุดุฑูุน ู ูพุงุงู ูุดุฎุต

```javascript
// ุทุฑุงุญ ฺฉู
class VotingSystem {
    // ุซุจุช ุฑุง
    async castVote(nationalId, vote) {
        // ฑ. ุงุญุฑุงุฒ ููุช
        if (!await this.authenticateUser(nationalId)) {
            throw new Error("ุงุญุฑุงุฒ ููุช ูุงูููู!");
        }

        // ฒ. ฺฺฉ ฺฉุฑุฏู ุฒูุงู
        if (!this.isVotingTime()) {
            throw new Error("ุฒูุงู ุฑุงโฺฏุฑ ุชูููู!");
        }

        // ณ. ฺฺฉ ฺฉุฑุฏู ุฑุง ูุจู
        if (await this.hasVoted(nationalId)) {
            throw new Error("ุดูุง ูุจูุง ุฑุง ุฏุงุฏุฏ!");
        }

        // ด. ุฑูุฒูฺฏุงุฑ ุฑุง
        const encryptedVote = this.encrypt(vote);

        // ต. ุซุจุช ุฑุง
        await this.saveVote(nationalId, encryptedVote);

        // ถ. ูุงฺฏ
        await this.log(`User voted at ${new Date()}`);
        // ุชูุฌู: ุฑุง ุฑู ูุงฺฏ ููโฺฉูู!
    }
}
```

</details>

## ๐ ููุงุจุน ุจุดุชุฑ

- [OWASP Secure Design Principles](https://owasp.org/www-project-secure-coding-practices/)
- [Threat Modeling Manifesto](https://www.threatmodelingmanifesto.org/)
- ฺฉุชุงุจ: "Threat Modeling: Designing for Security"

---

**ุงุฏุช ุจุงุดู: ู ุณุงุนุช ูฺฉุฑ ฺฉุฑุฏู ูุจู ุงุฒ ฺฉุฏ ุฒุฏูุ ุตุฏ ุณุงุนุช ุฏุจุงฺฏ ฺฉุฑุฏู ุจุนุฏ ุงุฒ ฺฉุฏ ุฒุฏู ุฑู ูโุงุฑุฒู! ๐ง๐ก**

**"Weeks of coding can save you hours of planning!" (ููุชูโูุง ฺฉุฏ ุฒุฏู ูโุชููู ุณุงุนุชโูุง ุจุฑูุงููโุฑุฒ ุฑู ุฐุฎุฑู ฺฉูู! - ุจู ุตูุฑุช ุทูุฒ ฺฏูุชู ุดุฏู!)**
